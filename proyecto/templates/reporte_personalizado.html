<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="/static/reporte.css">
    <title>Reporte Personalizado</title>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <h1>‚öôÔ∏è Reporte Personalizado</h1>
            <p>Configura los filtros para generar tu reporte</p>
        </div>

        <!-- Formulario -->
        <div class="form-card">
            <!-- Informaci√≥n -->
            <div class="info-box">
                <h4>üìã Instrucciones</h4>
                <ul>
                    <li>Selecciona los filtros que desees aplicar</li>
                    <li>Los campos vac√≠os ser√°n ignorados</li>
                    <li>Puedes combinar m√∫ltiples filtros</li>
                    <li>Elige el formato de salida (PDF o Excel)</li>
                </ul>
            </div>

            <form method="POST" action="/reporte/personalizado">
                <!-- Filtros -->
                <div class="form-section">
                    <h3>üîç Filtros de B√∫squeda</h3>

                    <div class="form-group">
                        <label for="semestre">Semestre</label>
                        <select name="semestre" id="semestre">
                            <option value="">-- Todos los semestres --</option>
                            <option value="1">1er Semestre</option>
                            <option value="2">2do Semestre</option>
                            <option value="3">3er Semestre</option>
                            <option value="4">4to Semestre</option>
                            <option value="5">5to Semestre</option>
                            <option value="6">6to Semestre</option>
                        </select>
                        <p class="help-text">Filtra alumnos por semestre espec√≠fico</p>
                    </div>

                    <div class="form-group">
                        <label for="turno">Turno</label>
                        <select name="turno" id="turno">
                            <option value="">-- Todos los turnos --</option>
                            <option value="Matutino">Matutino</option>
                            <option value="Vespertino">Vespertino</option>
                            <option value="Nocturno">Nocturno</option>
                        </select>
                        <p class="help-text">Selecciona el turno deseado</p>
                    </div>

                    <div class="form-group">
                        <label for="grupo">Grupo</label>
                        <input type="text" name="grupo" id="grupo" placeholder="Ej: A, B, C, 1A, 2B">
                        <p class="help-text">Filtra por grupo espec√≠fico (opcional)</p>
                    </div>
                </div>

                <!-- Formato -->
                <div class="form-section">
                    <h3>üìÑ Formato de Salida</h3>
                    
                    <div class="form-group">
                        <label>Selecciona el formato <span class="required">*</span></label>
                        <div class="radio-group">
                            <div class="radio-option">
                                <input type="radio" name="formato" id="formato_pdf" value="pdf" checked>
                                <label for="formato_pdf">üìÑ PDF</label>
                            </div>
                            <div class="radio-option">
                                <input type="radio" name="formato" id="formato_excel" value="excel">
                                <label for="formato_excel">üìä Excel</label>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Vista Previa -->
                <div class="preview-section">
                    <h4>üëÅÔ∏è Vista Previa</h4>
                    <p id="preview-text">
                        <strong>Filtros seleccionados:</strong> Todos los alumnos
                    </p>
                </div>

                <!-- Botones -->
                <div class="button-group">
                    <a href="/reportes" class="btn btn-secondary">‚Üê Cancelar</a>
                    <button type="submit" class="btn btn-primary">üöÄ Generar Reporte</button>
                </div>
            </form>
        </div>
    </div>

    <script>
        // Vista previa din√°mica
        function updatePreview() {
            const semestre = document.getElementById('semestre').value;
            const turno = document.getElementById('turno').value;
            const grupo = document.getElementById('grupo').value;
            const formato = document.querySelector('input[name="formato"]:checked').value;

            let filtros = [];
            
            if (semestre) filtros.push(`Semestre: ${semestre}`);
            if (turno) filtros.push(`Turno: ${turno}`);
            if (grupo) filtros.push(`Grupo: ${grupo}`);

            const previewText = document.getElementById('preview-text');
            
            if (filtros.length === 0) {
                previewText.innerHTML = '<strong>Filtros seleccionados:</strong> Todos los alumnos';
            } else {
                previewText.innerHTML = `<strong>Filtros seleccionados:</strong> ${filtros.join(', ')}`;
            }

            previewText.innerHTML += `<br><strong>Formato:</strong> ${formato.toUpperCase()}`;
        }

        // Event listeners
        document.getElementById('semestre').addEventListener('change', updatePreview);
        document.getElementById('turno').addEventListener('change', updatePreview);
        document.getElementById('grupo').addEventListener('input', updatePreview);
        document.querySelectorAll('input[name="formato"]').forEach(radio => {
            radio.addEventListener('change', updatePreview);
        });

        // Validaci√≥n antes de enviar
        document.querySelector('form').addEventListener('submit', function(e) {
            const semestre = document.getElementById('semestre').value;
            const turno = document.getElementById('turno').value;
            const grupo = document.getElementById('grupo').value;

            if (!semestre && !turno && !grupo) {
                const confirmar = confirm(
                    '‚ö†Ô∏è No has seleccionado ning√∫n filtro.\n\n' +
                    'Se generar√° un reporte con TODOS los alumnos.\n\n' +
                    '¬øDeseas continuar?'
                );
                
                if (!confirmar) {
                    e.preventDefault();
                }
            }
        });
    </script>
</body>
</html>